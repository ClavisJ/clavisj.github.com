<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta name="baidu-site-verification" content="AsDpnKjG4B"/>
    <title> Swift4 访问控制权限 · ClavisBlog </title>
    <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="browsermode" content="application">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="ClavisBlog">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="msapplication-navbutton-color" content="#666666">
<meta name= "format-detection" content="telephone=no" />
<meta name="keywords" content="nlvi, Nlvi" />





<link rel="stylesheet" href="/style/style.css" type="text/css">
<script src="/script/jquery.min.js" type="text/javascript"></script>
<script>
    var CONFIG = {
        title: "ClavisBlog",
        author: "Clavis JJ",
        lightbox: true,
        animate: true
    }
</script>



    <link rel="stylesheet" href="/lightbox/css/lightbox.min.css" type="text/css">




    <link rel="stylesheet" href="/syuanpi/syuanpi.min.css" type="text/css">










</head>
<body>
    <div class="progress">
    <div class="progress-inner"></div>
</div>
    <div class="body">
    <div class="tagcloud-mask"></div>  
<div class="tagcloud" id="tagcloud">
    <div class="tagcloud-inner">
        <a href="/tags/swift2/" style="font-size: 14px;">swift2</a>
    </div>
</div>
    <header class="header" id="header">
    <div class="title syuanpi tvIn">
    <div class="table">
        <div class="connect">
            <div class="connect-inner">
                <span><a href="/">ClavisBlog</a></span>
                
            </div>
        </div>
    </div>
</div>
    <nav class="main-nav syuanpi tvIn">
<div class="table">

    <ul class="menu">
        
        
        
            <li class="menu-item">
                <a href="/">
                    <span>文章</span>
                    
                        <span class="menu-item-label">article</span>
                    
                </a>
            </li>
        
        
        
            <li class="menu-item">
                <a href="/archives">
                    <span>归档</span>
                    
                        <span class="menu-item-label">archives</span>
                    
                </a>
            </li>
        
        
        
            <li class="menu-item">
                <a href="/read">
                    <span>读书</span>
                    
                        <span class="menu-item-label">read</span>
                    
                </a>
            </li>
        
        
    </ul>

</div>
</nav>
</header>
<div class="mobile-header">
    <div class="mobile-header-body">
        <div class="mobile-header-list">
            
            
                <div class="mobile-nav-item">
                    <a href="/">
                        <span>文章</span>
                        
                            <span class="menu-item-label">article</span>
                        
                    </a>
                </div>
            
            
            
                <div class="mobile-nav-item">
                    <a href="/archives">
                        <span>归档</span>
                        
                            <span class="menu-item-label">archives</span>
                        
                    </a>
                </div>
            
            
            
                <div class="mobile-nav-item">
                    <a href="/read">
                        <span>读书</span>
                        
                            <span class="menu-item-label">read</span>
                        
                    </a>
                </div>
            
            
        </div>
    </div>
    <div class="mobile-header-nav">
        <div class="mobile-header-item" id="mobile-left">
            <div class="header-menu-item">
                <span class="header-menu-line"></span>
            </div>
        </div>
        <h1 class="mobile-header-title">
            <a href="/">ClavisBlog</a>
        </h1>
        <div class="mobile-header-item"></div>
    </div>
</div>

    <div class="container">
        <main class="main" id="main">
            
    
    <article class="post">
        <header class="post-header">
            <div class="post-time syuanpi riseIn-light back-1">
                <span>2017年12月26日</span>
                
                
                    <span class="post-category"><a href="/categories/iOS/">iOS</a></span>
                
                
            </div>
            <h1 class="post-title syuanpi riseIn-light back-2">
            
                Swift4 访问控制权限
            
            </h1>
            
                
            
        </header>
        <div class="post-content syuanpi riseIn-light back-3">
            
                <p><code>Swift 3</code> 中，新增了 <code>fileprivate</code> 和 <code>open</code> 权限，而在<code>Swift4</code> 中，对 <code>fileprivate</code> 和 <code>private</code> 的访问范围做出了调整，本文来梳理下 <code>Swift</code> 中所有的访问控制权限的使用范围。</p>
<a id="more"></a>
<p>首先，访问控制限制你在不同源文件和 <code>module</code> 之前代码和代码之前的访问。这个特性让你可以隐藏一些代码的实现，和明确一些可以访问和使用的接口。你可以给类，结构体，枚举，属性，方法，构造器，下标，协议等指定访问等级。</p>
<br>



<h3 id="Modules_和_源文件">Modules 和 源文件</h3><p><code>Swift</code> 的访问控制模型是基于 <code>module</code> 和 源文件的。</p>
<p>在 <code>Swift</code> 文档中对 <code>module</code> 和源文件的解释如下：</p>
<p>一个 <code>module</code> 是一个独立的代码建造单元，例如一个 <code>framework</code> 或者 <code>application</code> 可以构建和包装成一个可以被其他 <code>module</code> 通过 <code>Swift</code> 的关键字 <code>import</code> 的单元。</p>
<p>在 <code>Xcode</code> 中的每个编译 <code>target</code> （例如一个 <code>app bundle</code> 或者 <code>framework</code>）都被视作 <code>Swift</code> 里的一个单独的 <code>module</code>。如果将应用程序代码的各个部分组合成一个独立的框架，也许可以在多个应用程序中封装和重用这些代码，那么当它被导入并在程序中使用时，或者在另一个 <code>framework</code> 中使用时，在该框架中定义的所有内容都将是独立 <code>module</code> 的一部分。</p>
<p>一个源文件是在一个 <code>module</code> 里单独的 <code>Swift</code> 源码（或在 一个 <code>app</code> 或 <code>framework</code> 里的单独的文件） 。虽然常见的是在分开的源文件里定义单独的类型，但一个单独的源文件也能包含多个类型，方法等的定义。</p>
<br>

<h3 id="访问级别">访问级别</h3><p><code>Swift</code> 提供 5 个不同的访问级别，权限最高的是 <code>open</code>，依次是 <code>public</code>，<code>internal</code>，<code>fileprivate</code>，最低的是 <code>private</code>。默认使用的级别是 <code>internal</code>。</p>
<h4 id="open">open</h4><p>使用 <code>open</code> 和 <code>public</code> 标记的实体在他们定义的 <code>module</code> 中的任意文件中都可以使用，并且在 <code>import</code> 了其定义的 <code>module</code> 的其他 <code>module</code> 的源文件中也能使用。一般在 <code>framework</code> 中指定公开的接口里使用 <code>open</code> 或者 <code>public</code> 级别。</p>
<br>

<h4 id="open_和_public_的区别如下">open 和 public 的区别如下</h4><ul>
<li>拥有 <code>public</code> 权限或者更低权限的类，只能在其定义的 <code>module</code> 中被子类化</li>
<li>拥有 <code>public</code> 权限或者更低权限的类的成员，只能在其定义的 <code>module</code> 中被重写或子类化</li>
<li><code>open</code> 权限的类可以在其定义和 <code>import</code> 的 <code>module</code> 中子类化</li>
<li><code>open</code> 权限的类成员可以在其定义和 <code>import</code> 的 <code>module</code> 中被重写或子类化</li>
</ul>
<br>

<h4 id="internal">internal</h4><p><code>internal</code> 修饰的实体在其定义 <code>module</code> 中的任意源文件中都可以访问，但是在其他 <code>module</code> 的任意源文件中都访问不了。一般在定义<code>app</code> 或者 <code>framework</code> 内部的结构的时候，使用 <code>internal</code> 级别。</p>
<br>

<h4 id="fileprivate">fileprivate</h4><p><code>fileprivate</code> 限制了只能在其定义的源文件里面使用。使用 <code>fileprivate</code> 权限以隐藏其实现细节。当其只在整个源文件中使用的时候，使用 <code>fileprivate</code> 修饰。</p>
<br>

<h4 id="private">private</h4><p><code>private</code> 访问权限限制其只能在定义的范围内，和其在同一文件中的 <code>extension</code> 中使用。当其只在当个声明中使用的时候，使用 <code>private</code> 修饰。</p>
<br>

<h3 id="访问权限的使用原则">访问权限的使用原则</h3><h4 id="统一的原则">统一的原则</h4><p>一个实体不能根据另一个级别更低的实体来定义。</p>
<br>

<h4 id="单元测试_Targaets_的访问权限">单元测试 Targaets 的访问权限</h4><p>一般来说，只有标注为 <code>open</code> 或 <code>public</code> 的实体才能在其他 <code>module</code> 中访问，但是，在单元测试的 <code>target</code> 中，能访问任意模块中拥有 <code>@testable</code> 的实体。</p>
<br>

<h4 id="元组">元组</h4><p>元组的访问级别不能像类，结构体那样单独定义。它的访问级别是自动推断出来的，使用元组元素中最低的级别。</p>
<p>方法的访问权限取决于参数和返回值中最低的访问权限。并且当访问权限于上下文默认的不符时，你必须明确的表明访问权限。例如如下的方法将编译不通过，需要指明 <code>private</code> 或者 <code>fileprivate</code>。</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">testFunction</span><span class="params">()</span> -&gt; <span class="params">(SomeInternalClass, SomePrivateClass)</span> &#123;</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<br>

<h4 id="枚举">枚举</h4><p>枚举的每个值都和他们所属的枚举拥有相同的级别，并且并不能定义单独的访问级别。</p>
<p>如下，一个 <code>public</code> 的枚举，其中的 <code>north</code>，<code>south</code>，<code>east</code>，<code>west</code> 的访问级别都是 <code>public</code>。</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">enum</span> <span class="title">CompassPoint</span> &#123;</span></span><br><span class="line">    <span class="keyword">case</span> north</span><br><span class="line">    <span class="keyword">case</span> south</span><br><span class="line">    <span class="keyword">case</span> east</span><br><span class="line">    <span class="keyword">case</span> west</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>枚举值的关联值或真实值的访问级别也必须至少和枚举值一样高。</p>
<br>

<h4 id="子类">子类</h4><p>子类的访问级别不能高于父类，但是子类复写的父类方法的访问级别可以高于父类。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    fileprivate <span class="func"><span class="keyword">func</span> <span class="title">someMethod</span><span class="params">()</span></span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">internal <span class="class"><span class="keyword">class</span> <span class="title">B</span>: <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> internal <span class="func"><span class="keyword">func</span> <span class="title">someMethod</span><span class="params">()</span></span> &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<br>

<h4 id="协议">协议</h4><p>你可以给协议指定访问级别，并且对于协议的每一项来说，访问级别都和协议相同。并且你不能单独给协议中单独的方法等定义不同的访问级别。</p>
<p>​                                                                                                                                                                                                                                                                                                                                                                                                                                        </p>

            
        
        </div>
        
            
            
        
    </article>
    
        
    <nav class="article-page">
        
        
            <a href="/Hexo/hexo-customized-nlvi-theme/" id="art-right" class="art-left">
                <span class="prev-title"> 
                    <i class="iconfont icon-left"></i>Hexo 定制 Nlvi 主题
                </span>
            </a>
        
    </nav>

        
    <i id="com-switch" class="iconfont icon-more jumping-in long infinite" style="font-size:24px;display:block;text-align:center;transform:rotate(180deg);"></i>
    <div class="post-comments" id="post-comments" style="display: block;margin: auto 16px;">
    
        <link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
		<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
		<script>
			var gitment = new Gitment({
			owner: 'ClavisJ',
			repo: 'HexoComment',
			oauth: {
			client_id: '4608bfda19fb959ee598',
			client_secret: '87b14f10d2de221a07d19bc1f1222cd05a3f54ce',
			},
			})
			gitment.render('post-comments')
		</script>
    </div>

	<script>
	(function(){
	    var bp = document.createElement('script');
	    var curProtocol = window.location.protocol.split(':')[0];
	    if (curProtocol === 'https') {
	        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
	    }
	    else {
	        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
	    }
	    var s = document.getElementsByTagName("script")[0];
	    s.parentNode.insertBefore(bp, s);
	})();
	</script>


    


        </main>
        <footer class="footer syuanpi fadeIn" id="footer">
    <hr>
    <div class="footer-wrapper">
        <div class="left">
            <div class="contact-icon">
    
    
    
    
    
    
    
    
    
        
            <a href="https://github.com/ClavisJ" class="iconfont icon-github" title="github"></a>
        
        
        
        
        
        
        
        
    
        
        
            <a href="https://weibo.com//u/2833253020" class="iconfont icon-weibo" title="weibo"></a>
        
        
        
        
        
        
        
    
        
        
        
        
        
        
        
        
            <a href="mailto:ClavisJJ@gmail.com" target="_blank" class="iconfont icon-mail" title="mail"></a>
        
    
</div>
        </div>
        <div class="right">
            <div class="copyright">
    <div class="info">
        <span>&copy;</span>
        <span>1970 ~ 2018</span>
        <span>❤</span>
        <span>Clavis JJ</span>
    </div>
    <div class="theme">
        <span>
            动力来源于
            <a href="http://hexo.io/" target="_blank">Hexo </a>
        </span>
        <span>
            主题
            <a href="https://github.com/ColMugX/hexo-theme-Nlvi"> Nlvi </a>
        </span>
    </div>
    
</div>
        </div>
    </div>
</footer>
    </div>
    <script src="/script/nlvi.js" type="text/javascript"></script>
<script src="/script/search.js" type="text/javascript"></script>

    <script src="/lightbox/js/lightbox.min.js" type="text/javascript"></script>

<script>
$(document).ready(function(){
    document.body.addEventListener('touchstart', function () {});
    $('.progress').hide();
    $('.body').show();
    Nlvi.tagcloud();
    Nlvi.mobileHeader();
    Nlvi.back2top();
    Nlvi.smoothScroll();
    Nlvi.onView();
    Nlvi.showToc();
    Nlvi.showComments();
    Nlvi.showReward();

    !CONFIG.animate && Nlvi.offAnimate();
    CONFIG.lightbox && Nlvi.onPicBox();
})
</script>
    </div>
    
        
    
    <div class="backtop syuanpi dead toTop" id="backtop">
    <i class="iconfont icon-up"></i>
    <span style="text-align:center;font-family:Georgia;"><span style="font-family:Georgia;" id="scrollpercent">1</span>%</span>
</div>
    
</body>
</html>
